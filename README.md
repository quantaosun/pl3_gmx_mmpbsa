# pl3_gmx_mmpbsa
Local Unix use or binder use

An example of the final result of such a calculation (per-residue decomposition of binding free energy)

![image](https://user-images.githubusercontent.com/75652473/227806027-582f8193-be45-46d0-9483-eb8bb01a3b7a.png)


![image](https://user-images.githubusercontent.com/75652473/227806111-64392237-340c-46e8-a872-9af281707ea4.png)

[![Use on Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/quantaosun/pl3_gmx_mmpbsa/HEAD)

Recommened workflow.
1. Docking with pl3 as per https://github.com/quantaosun/pl3
2. MD input files generation with Charmm gui input generator (solution builder), with files generated by pl3
3. MD simulation with local gromacs or gmx inside this pl3_gmx_mmpbsa binder environment
```
modify REAMD for loop to only run the first 1, with step5.production.mdp nsteps extended 10 times of original value

```
4. MMPBSA calcultion of protein-ligand based on MD trajectories (and per-residue decomposition)
5. Visualisation and/or chart/imge making with gmx_MMPBSA_ana 



Elaboration on step 3, modify README to only run 1 nano second instead of 10, so the final trajectory only named as step5_1.xtc, and all mmpbsa calculation will be on the basis of step5_1


Elaboration on step 4. To know the index for protein and ligand, run

```
gmx make_ndx -f step5_1.gro -o index2.ndx

```

To run mmpbsa calculation with decompositon 

```
gmx_MMPBSA -O -i mmpbsa.in -cs step5_1.tpr -ci index2.ndx -cg 1 13 -ct step5_1.xtc -cp topol.top -o FINAL_RESULTS.dat -eo FINAL_RESULTS.csv

```
where mmpbsa.in is 

```
&general
sys_name="Prot-Lig-ST",
startframe=1,
endframe=12,
/
&gb
igb=5, saltcon=0.150,
/

&decomp
idecomp=2, dec_verbose=3,
print_res="within 4"
/
```
